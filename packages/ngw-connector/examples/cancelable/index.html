<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cancelable Request Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="../../lib/ngw-connector.global.js"></script>
  </head>

  <body>
    <script>
      const output = document.createElement('div');
      document.body.appendChild(output);

      const connector = new NgwConnector({
        baseUrl: 'https://demo.nextgis.com',
      });

      connector.connect().then(() => {
        const abortController = new AbortController(); // Create a new AbortController instance

        connector
          .route('resource.collection', { id: 4005 })
          .get({ signal: abortController.signal }) // Pass abort signal to the request
          .then((response) => {
            output.innerHTML = `<p>Request successful:</p><pre>${JSON.stringify(response, null, 2)}</pre>`;
          })
          .catch((e) => {
            if (e.name === 'AbortError') {
              output.innerHTML = '<p>Request was aborted</p>';
            } else {
              output.innerHTML = `<p>Request failed:</p><pre>${e}</pre>`;
            }
          });

        // Simulate request abort after 10 ms
        setTimeout(() => {
          abortController.abort();
        }, 10);
      });
    </script>
  </body>
</html>
