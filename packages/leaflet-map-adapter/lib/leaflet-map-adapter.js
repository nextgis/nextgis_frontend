!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("leaflet"),require("events")):"function"==typeof define&&define.amd?define(["leaflet","events"],e):"object"==typeof exports?exports.LeafletMapAdapter=e(require("leaflet"),require("events")):t.LeafletMapAdapter=e(t.leaflet,t.events)}(window,function(t,e){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){var n,o,i;
/*!
 * leaflet.wms.js
 * A collection of Leaflet utilities for working with Web Mapping services.
 * (c) 2014-2016, Houston Engineering, Inc.
 * MIT License
 */o=[r(0)],void 0===(i="function"==typeof(n=function(t){var e={};"keys"in Object||(Object.keys=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}),e.Source=t.Layer.extend({options:{untiled:!0,identify:!0},initialize:function(e,r){t.setOptions(this,r),this.options.tiled&&(this.options.untiled=!1),this._url=e,this._subLayers={},this._overlay=this.createOverlay(this.options.untiled)},createOverlay:function(t){var r={};for(var n in this.options)"untiled"!=n&&"identify"!=n&&(r[n]=this.options[n]);return t?e.overlay(this._url,r):e.tileLayer(this._url,r)},onAdd:function(){this.refreshOverlay()},getEvents:function(){return this.options.identify?{click:this.identify}:{}},setOpacity:function(t){this.options.opacity=t,this._overlay&&this._overlay.setOpacity(t)},bringToBack:function(){this.options.isBack=!0,this._overlay&&this._overlay.bringToBack()},bringToFront:function(){this.options.isBack=!1,this._overlay&&this._overlay.bringToFront()},getLayer:function(t){return e.layer(this,t)},addSubLayer:function(t){this._subLayers[t]=!0,this.refreshOverlay()},removeSubLayer:function(t){delete this._subLayers[t],this.refreshOverlay()},refreshOverlay:function(){var t=Object.keys(this._subLayers).join(",");this._map&&(t?(this._overlay.setParams({layers:t}),this._overlay.addTo(this._map)):this._overlay.remove())},identify:function(t){var e=this.getIdentifyLayers();e.length&&this.getFeatureInfo(t.containerPoint,t.latlng,e,this.showFeatureInfo)},getFeatureInfo:function(e,r,n,o){var i=this.getFeatureInfoParams(e,n),a=this._url+t.Util.getParamString(i,this._url);this.showWaiting(),this.ajax(a,function(t){this.hideWaiting();var e=this.parseFeatureInfo(t,a);o.call(this,r,e)})},ajax:function(t,e){(function(t,e){var r=this,n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status?e.call(r,n.responseText):e.call(r,"error"))},n.open("GET",t),n.send()}).call(this,t,e)},getIdentifyLayers:function(){return this.options.identifyLayers?this.options.identifyLayers:Object.keys(this._subLayers)},getFeatureInfoParams:function(e,r){var n,o;this.options.untiled?n=this._overlay.wmsParams:((o=this.createOverlay(!0)).updateWmsParams(this._map),(n=o.wmsParams).layers=r.join(","));var i={request:"GetFeatureInfo",query_layers:r.join(","),X:Math.round(e.x),Y:Math.round(e.y)};return t.extend({},n,i)},parseFeatureInfo:function(t,e){return"error"==t&&(t="<iframe src='"+e+"' style='border:none'>"),t},showFeatureInfo:function(t,e){this._map&&this._map.openPopup(e,t)},showWaiting:function(){this._map&&(this._map._container.style.cursor="progress")},hideWaiting:function(){this._map&&(this._map._container.style.cursor="default")}}),e.source=function(t,r){return new e.Source(t,r)},e.Layer=t.Layer.extend({initialize:function(r,n,o){t.setOptions(this,o),r.addSubLayer||(r=e.getSourceForUrl(r,o)),this._source=r,this._name=n},onAdd:function(){this._source._map||this._source.addTo(this._map),this._source.addSubLayer(this._name)},onRemove:function(){this._source.removeSubLayer(this._name)},setOpacity:function(t){this._source.setOpacity(t)},bringToBack:function(){this._source.bringToBack()},bringToFront:function(){this._source.bringToFront()}}),e.layer=function(t,r){return new e.Layer(t,r)};var r={};return e.getSourceForUrl=function(t,n){return r[t]||(r[t]=e.source(t,n)),r[t]},e.TileLayer=t.TileLayer.WMS,e.tileLayer=t.tileLayer.wms,e.Overlay=t.Layer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},options:{crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18},initialize:function(e,r){this._url=e;var n={},o={};for(var i in r)i in this.options?o[i]=r[i]:n[i]=r[i];t.setOptions(this,o),this.wmsParams=t.extend({},this.defaultWmsParams,n)},setParams:function(e){t.extend(this.wmsParams,e),this.update()},getAttribution:function(){return this.options.attribution},onAdd:function(){this.update()},onRemove:function(t){this._currentOverlay&&(t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl},getEvents:function(){return{moveend:this.update}},update:function(){if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!=e){this._currentUrl=e;var r=this._map.getBounds(),n=t.imageOverlay(e,r,{opacity:0});n.addTo(this._map),n.once("load",function(){this._map&&(n._url==this._currentUrl?(this._currentOverlay&&this._map.removeLayer(this._currentOverlay),this._currentOverlay=n,n.setOpacity(this.options.opacity?this.options.opacity:1),!0===this.options.isBack&&n.bringToBack(),!1===this.options.isBack&&n.bringToFront(),void 0!==this.options.zIndex&&n.setZIndex(this.options.zIndex)):this._map.removeLayer(n))},this),(this._map.getZoom()<this.options.minZoom||this._map.getZoom()>this.options.maxZoom)&&this._map.removeLayer(n)}}},setOpacity:function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)},bringToBack:function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()},bringToFront:function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()},setZIndex:function(t){this.options.zIndex=t,this._currentOverlay&&this._currentOverlay.setZIndex(t)},updateWmsParams:function(e){e||(e=this._map);var r=e.getBounds(),n=e.getSize(),o=parseFloat(this.wmsParams.version),i=this.options.crs||e.options.crs,a=o>=1.3?"crs":"srs",s=i.project(r.getNorthWest()),u=i.project(r.getSouthEast()),c={width:n.x,height:n.y};c[a]=i.code,c.bbox=(o>=1.3&&i===t.CRS.EPSG4326?[u.y,s.x,s.y,u.x]:[s.x,u.y,u.x,s.y]).join(","),t.extend(this.wmsParams,c)},getImageUrl:function(){var e=this.options.uppercase||!1,r=t.Util.getParamString(this.wmsParams,this._url,e);return this._url+r}}),e.overlay=function(t,r){return new e.Overlay(t,r)},e})?n.apply(e,o):n)||(t.exports=i)},function(t,e,r){"use strict";r.r(e);var n=r(0),o=r(1),i=1,a=function(){function t(t,e){this.map=t,this.name=e.id||String(i++),this.options=Object.assign({},this.options,e)}return t.prototype.addLayer=function(t){return null},t}(),s=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]])}return r},c=1,p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.addLayer=function(t){this.name=t.id||"tile-"+c++;var e=t.url,r=u(t,["url"]);return new n.TileLayer(e,r)},e}(a),h=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=1,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.addLayer=function(t){return this.name=t.id||"geojson-"+y++,new n.GeoJSON(t.data,t)},e}(a),f=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=function(t){function e(e){var r=t.call(this,e)||this;e.customAttribution&&[].concat(e.customAttribution).forEach(function(t){return r.addAttribution(t)});return r}return f(e,t),e}(n.Control.Attribution),m=r(2),_=r.n(m),v=function(){return(v=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},g=1,O=function(){function t(){}return t.prototype.addLayer=function(t){var e=(t=v({transparent:!0},t)).updateWmsParams;if(this.name=t.id||"image-"+g++,this.layer=_.a.overlay(t.url,t),e){var r=this.layer.updateWmsParams;this.layer.updateWmsParams=function(t){r.call(this,t),this.wmsParams=e(this.wmsParams)}}return this.layer},t}(),b=function(){function t(){this.options={target:"map"},this.layerAdapters=t.layerAdapters,this.displayProjection="EPSG:3857",this.lonlatProjection="EPSG:4326",this.emitter=new o.EventEmitter,this._layers={},this.DPI=1e3/39.37/.28,this.IPM=39.37,this._order=0,this._length=9999,this._baseLayers=[]}return t.prototype.create=function(t){void 0===t&&(t={target:"map"}),this.options=Object.assign({},t),this.map=new n.Map(this.options.target,{zoomControl:!1,attributionControl:!1}),this.emitter.emit("create",{map:this.map}),this._addMapListeners()},t.prototype.getContainer=function(){return this.map.getContainer()},t.prototype.onMapLoad=function(t){return new Promise(function(e){e(t&&t())})},t.prototype.setCenter=function(t){this.map.setView(t,this.map.getZoom())},t.prototype.setZoom=function(t){this.map.setZoom(t)},t.prototype.fit=function(t){this.map.fitBounds([[t[3],t[0]],[t[1],t[2]]])},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype.getLayer=function(t){return void 0!==this._layers[t]},t.prototype.getLayers=function(){return Object.keys(this._layers)},t.prototype.isLayerOnTheMap=function(t){return this._layers[t].onMap},t.prototype.addControl=function(e,r,n){var o;if("string"==typeof e){var i=t.controlAdapters[e];i&&(o=new i(n))}else o=e;if(o)return o.options.position=r.replace("-",""),this.map.addControl(o),o},t.prototype.addLayer=function(t,e,r){var n,o=this;if(n="string"==typeof t?this.getLayerAdapter(t):t){var i=new n(this.map,e),a=i.addLayer(e),s=i.addLayer(e),u=function(t){var n=i.name,a={layer:t,onMap:!1};return r?(a.baseLayer=!0,o._baseLayers.push(n)):a.order=e.order||o._order++,o._layers[n]=a,i};return s.then?s.then(function(t){return u(t)}):Promise.resolve(u(a))}return Promise.reject("No adapter")},t.prototype.removeLayer=function(t){},t.prototype.showLayer=function(t){this.toggleLayer(t,!0)},t.prototype.hideLayer=function(t){this.toggleLayer(t,!1)},t.prototype.setLayerOpacity=function(t,e){},t.prototype.getScaleForResolution=function(t,e){return parseFloat(t)*(e*this.IPM*this.DPI)},t.prototype.getResolutionForScale=function(t,e){return parseFloat(t)/(e*this.IPM*this.DPI)},t.prototype.toggleLayer=function(t,e){var r=this,o=function(t,o){if(e){if(t instanceof n.Map&&(o.layer.addTo(t),o.layer.setZIndex)){var i=o.baseLayer?0:r._length-o.order;o.layer.setZIndex(i)}}else t.removeLayer(o.layer);o.onMap=e},i=this._layers[t];i&&i.onMap!==e&&(this.map?o(this.map,i):this.emitter.once("create",function(t){o(t.map,i)}))},t.prototype.onMapClick=function(t){var e=t.containerPoint,r=t.latlng;this.emitter.emit("click",{latLng:r,pixel:{left:e.x,top:e.y},source:t})},t.prototype._addMapListeners=function(){var t=this;this.map.on("click",function(e){t.onMapClick(e)})},t.layerAdapters={IMAGE:O,TILE:p,GEOJSON:l},t.controlAdapters={ZOOM:n.Control.Zoom,ATTRIBUTION:d},t}();e.default=b}]).default});
//# sourceMappingURL=leaflet-map-adapter.js.map