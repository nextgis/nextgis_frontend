{"version":3,"sources":["webpack://OlMapAdapter/webpack/universalModuleDefinition","webpack://OlMapAdapter/webpack/bootstrap","webpack://OlMapAdapter/external \"ol/proj\"","webpack://OlMapAdapter/external \"ol/layer/Tile\"","webpack://OlMapAdapter/external \"ol\"","webpack://OlMapAdapter/external \"ol/control\"","webpack://OlMapAdapter/external \"ol/extent\"","webpack://OlMapAdapter/external \"ol/format\"","webpack://OlMapAdapter/external \"ol/geom/Polygon\"","webpack://OlMapAdapter/external \"ol/source/ImageWMS\"","webpack://OlMapAdapter/external \"ol/layer/Image\"","webpack://OlMapAdapter/external \"events\"","webpack://OlMapAdapter/external \"ol/source/OSM\"","webpack://OlMapAdapter/external \"ol/geom/Point\"","webpack://OlMapAdapter/external \"ol/Feature\"","webpack://OlMapAdapter/external \"ol/layer\"","webpack://OlMapAdapter/external \"ol/source/Vector\"","webpack://OlMapAdapter/external \"ol/source/XYZ\"","webpack://OlMapAdapter/./src/layer-adapters/ImageAdapter.ts","webpack://OlMapAdapter/./src/layer-adapters/OsmAdapter.ts","webpack://OlMapAdapter/./src/layer-adapters/MarkerAdapter.ts","webpack://OlMapAdapter/./src/layer-adapters/TileAdapter.ts","webpack://OlMapAdapter/./src/ol-map-adapter.ts"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__3__","__WEBPACK_EXTERNAL_MODULE__4__","__WEBPACK_EXTERNAL_MODULE__5__","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__8__","__WEBPACK_EXTERNAL_MODULE__9__","__WEBPACK_EXTERNAL_MODULE__10__","__WEBPACK_EXTERNAL_MODULE__11__","__WEBPACK_EXTERNAL_MODULE__12__","__WEBPACK_EXTERNAL_MODULE__13__","__WEBPACK_EXTERNAL_MODULE__14__","__WEBPACK_EXTERNAL_MODULE__15__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ID","ImageAdapter_ImageAdapter","ImageAdapter","addLayer","options","this","id","imageOptions","url","params","resource","resourceId","ratio","updateWmsParams","imageLoadFunction","image","src","split","_a","str","val","dec","decodeURIComponent","qp","ret","length","item","indexOf","slice","Array","isArray","push","queryToObject","BBOX","WIDTH","HEIGHT","queryString","objectToQuery","obj","prefix","k","v","encodeURIComponent","join","bbox","width","height","getImage","source","ImageWMS_default","a","layer","Image_default","OsmAdapter_OsmAdapter","OsmAdapter","Tile_default","OSM_default","MarkerAdapter_ID","MarkerAdapter_MarkerAdapter","MarkerAdapter","latLng","lat","lng","point","Feature_default","geometry","Point_default","proj_","Vector_default","features","layer_","TileAdapter_ID","TileAdapter_TileAdapter","TileAdapter","XYZ_default","ol_map_adapter_OlMapAdapter","OlMapAdapter","layerAdapters","displayProjection","lonlatProjection","emitter","external_events_","_layers","_baseLayers","_order","_length","DPI","IPM","target","assign","view","external_ol_","center","zoom","projection","mapInitOptions","__assign","logo","controls","layers","map","emit","_olView","getView","_addMapListeners","getContainer","document","getElementById","onMapLoad","cb","Promise","resolve","setCenter","setZoom","fit","e","toExtent","setRotation","angle","getLayerAdapter","getLayer","layerName","undefined","getLayers","keys","isLayerOnTheMap","onMap","adapterDef","baselayer","adapterEngine","_this","adapter_1","addlayerFun","toResolve_1","layerId","layerOpts","baseLayer","order","then","reject","removeLayer","index","splice","showLayer","toggleLayer","hideLayer","setLayerOpacity","getScaleForResolution","res","mpu","parseFloat","getResolutionForScale","scale","status","action","setZIndex","once","data","addControl","controlDef","position","control","engine","controlAdapters","onMapClick","evt","coordinate","pixel","left","top","requestGeomString","pixelRadius","olMap","bounds","extent_","getCoordinateFromPixel","format_","writeGeometry","Polygon_","on","IMAGE","TILE","OSM","MARKER","ZOOM","control_","ATTRIBUTION","__webpack_exports__"],"mappings":"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","file":"ol-map-adapter.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"ol/proj\"), require(\"ol/layer/Tile\"), require(\"ol\"), require(\"ol/control\"), require(\"ol/extent\"), require(\"ol/format\"), require(\"ol/geom/Polygon\"), require(\"ol/source/ImageWMS\"), require(\"ol/layer/Image\"), require(\"events\"), require(\"ol/source/OSM\"), require(\"ol/geom/Point\"), require(\"ol/Feature\"), require(\"ol/layer\"), require(\"ol/source/Vector\"), require(\"ol/source/XYZ\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"ol/proj\", \"ol/layer/Tile\", \"ol\", \"ol/control\", \"ol/extent\", \"ol/format\", \"ol/geom/Polygon\", \"ol/source/ImageWMS\", \"ol/layer/Image\", \"events\", \"ol/source/OSM\", \"ol/geom/Point\", \"ol/Feature\", \"ol/layer\", \"ol/source/Vector\", \"ol/source/XYZ\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"OlMapAdapter\"] = factory(require(\"ol/proj\"), require(\"ol/layer/Tile\"), require(\"ol\"), require(\"ol/control\"), require(\"ol/extent\"), require(\"ol/format\"), require(\"ol/geom/Polygon\"), require(\"ol/source/ImageWMS\"), require(\"ol/layer/Image\"), require(\"events\"), require(\"ol/source/OSM\"), require(\"ol/geom/Point\"), require(\"ol/Feature\"), require(\"ol/layer\"), require(\"ol/source/Vector\"), require(\"ol/source/XYZ\"));\n\telse\n\t\troot[\"OlMapAdapter\"] = factory(root[\"ol/proj\"], root[\"ol/layer/Tile\"], root[\"ol\"], root[\"ol/control\"], root[\"ol/extent\"], root[\"ol/format\"], root[\"ol/geom/Polygon\"], root[\"ol/source/ImageWMS\"], root[\"ol/layer/Image\"], root[\"events\"], root[\"ol/source/OSM\"], root[\"ol/geom/Point\"], root[\"ol/Feature\"], root[\"ol/layer\"], root[\"ol/source/Vector\"], root[\"ol/source/XYZ\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__, __WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__3__, __WEBPACK_EXTERNAL_MODULE__4__, __WEBPACK_EXTERNAL_MODULE__5__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__7__, __WEBPACK_EXTERNAL_MODULE__8__, __WEBPACK_EXTERNAL_MODULE__9__, __WEBPACK_EXTERNAL_MODULE__10__, __WEBPACK_EXTERNAL_MODULE__11__, __WEBPACK_EXTERNAL_MODULE__12__, __WEBPACK_EXTERNAL_MODULE__13__, __WEBPACK_EXTERNAL_MODULE__14__, __WEBPACK_EXTERNAL_MODULE__15__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","module.exports = __WEBPACK_EXTERNAL_MODULE__4__;","module.exports = __WEBPACK_EXTERNAL_MODULE__5__;","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__8__;","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","module.exports = __WEBPACK_EXTERNAL_MODULE__11__;","module.exports = __WEBPACK_EXTERNAL_MODULE__12__;","module.exports = __WEBPACK_EXTERNAL_MODULE__13__;","module.exports = __WEBPACK_EXTERNAL_MODULE__14__;","module.exports = __WEBPACK_EXTERNAL_MODULE__15__;","import { LayerAdapter, ImageAdapterOptions } from '@nextgis/webmap';\r\nimport ImageWMS from 'ol/source/ImageWMS';\r\nimport ImageLayer from 'ol/layer/Image';\r\n\r\nlet ID = 1;\r\n\r\nexport class ImageAdapter implements LayerAdapter {\r\n\r\n  name: string;\r\n  layer: any;\r\n\r\n  addLayer(options?: ImageAdapterOptions) {\r\n\r\n    this.name = options.id || 'image-' + ID++;\r\n\r\n    const imageOptions: any = {\r\n      url: options.url,\r\n      params: {\r\n        resource: options.resourceId || options.id,\r\n      },\r\n      ratio: 1,\r\n    };\r\n\r\n    if (options.updateWmsParams) {\r\n      imageOptions.imageLoadFunction = (image, src) => {\r\n        const url = src.split('?')[0];\r\n        const query = src.split('?')[1];\r\n        const { resource, BBOX, WIDTH, HEIGHT } = queryToObject(query);\r\n        const queryString = objectToQuery(options.updateWmsParams({\r\n          resource,\r\n          bbox: BBOX,\r\n          width: WIDTH,\r\n          height: HEIGHT\r\n        }));\r\n        image.getImage().src = url + '?' + queryString;\r\n\r\n        // image.getImage().src = url\r\n        //   + '?resource=' + queryObject.resource\r\n        //   + '&extent=' + queryObject.BBOX\r\n        //   + '&size=' + queryObject.WIDTH + ',' + queryObject.HEIGHT\r\n        //   + '#' + Date.now(); // in-memory cachтe busting\r\n      };\r\n    }\r\n\r\n    const source = new ImageWMS(imageOptions);\r\n\r\n    const layer = new ImageLayer({ source });\r\n    this.layer = layer;\r\n    return layer;\r\n  }\r\n}\r\n\r\n// TODO: move to utils or rewrite with native js methods\r\nfunction queryToObject(str: string) {\r\n\r\n  const dec = decodeURIComponent;\r\n  const qp = str.split('&');\r\n  const ret: { [name: string]: any } = {};\r\n  let name;\r\n  let val;\r\n  for (let i = 0, l = qp.length, item; i < l; ++i) {\r\n    item = qp[i];\r\n    if (item.length) {\r\n      const s = item.indexOf('=');\r\n      if (s < 0) {\r\n        name = dec(item);\r\n        val = '';\r\n      } else {\r\n        name = dec(item.slice(0, s));\r\n        val = dec(item.slice(s + 1));\r\n      }\r\n      if (typeof ret[name] === 'string') { // inline'd type check\r\n        ret[name] = [ret[name]];\r\n      }\r\n\r\n      if (Array.isArray(ret[name])) {\r\n        ret[name].push(val);\r\n      } else {\r\n        ret[name] = val;\r\n      }\r\n    }\r\n  }\r\n  return ret; // Object\r\n}\r\n\r\nfunction objectToQuery(obj: object, prefix?: string): string {\r\n  const str = [];\r\n  let p;\r\n  for (p in obj) {\r\n    if (obj.hasOwnProperty(p)) {\r\n      const k = prefix ? prefix + '[' + p + ']' : p;\r\n      const v = obj[p];\r\n      str.push((v !== null && typeof v === 'object') ?\r\n        objectToQuery(v, k) :\r\n        encodeURIComponent(k) + '=' + encodeURIComponent(v));\r\n    }\r\n  }\r\n  return str.join('&');\r\n}\r\n","import { LayerAdapter } from '@nextgis/webmap';\r\nimport OSM from 'ol/source/OSM';\r\nimport TileLayer from 'ol/layer/Tile';\r\n\r\nexport class OsmAdapter implements LayerAdapter {\r\n\r\n  name = 'osm';\r\n\r\n  addLayer(options?) {\r\n    const layer = new TileLayer({\r\n      source: new OSM(),\r\n    });\r\n    return layer;\r\n  }\r\n\r\n}\r\n","import { LayerAdapter } from '@nextgis/webmap';\r\nimport Point from 'ol/geom/Point';\r\nimport Feature from 'ol/Feature';\r\nimport { fromLonLat } from 'ol/proj';\r\nimport {Vector as VectorLayer} from 'ol/layer';\r\nimport {Icon, Style} from 'ol/style.js';\r\nimport VectorSource from 'ol/source/Vector';\r\n\r\nlet ID = 1;\r\n\r\nexport class MarkerAdapter implements LayerAdapter {\r\n\r\n  name: string;\r\n\r\n  addLayer(options?) {\r\n\r\n    this.name = options.id || 'marker-' + ID++;\r\n\r\n    const {lat, lng} = options.latLng;\r\n\r\n    const point = new Feature({\r\n      geometry: new Point(fromLonLat([lng, lat])),\r\n     });\r\n\r\n    // const icon = new Icon({\r\n    //   color: '#4271AE',\r\n    //   crossOrigin: 'anonymous',\r\n    //   // src: 'data/dot.png'\r\n    // });\r\n\r\n    // point.setStyle(new Style({\r\n    //   image: icon\r\n    // }));\r\n\r\n    const source = new VectorSource({\r\n      features: [point],\r\n    });\r\n\r\n    const layer = new VectorLayer({\r\n      source,\r\n    });\r\n\r\n    return layer;\r\n  }\r\n}\r\n","import { LayerAdapter } from '@nextgis/webmap';\nimport TileLayer from 'ol/layer/Tile';\nimport XYZ from 'ol/source/XYZ';\n\nlet ID = 1;\n\nexport class TileAdapter implements LayerAdapter {\n\n  name: string;\n\n  addLayer(options?) {\n\n    this.name = options.id || 'tile-' + ID++;\n\n    const layer = new TileLayer({\n      source: new XYZ({\n        url: options.url,\n      }),\n    });\n    return layer;\n  }\n\n}\n","import { MapAdapter } from '@nextgis/webmap';\nimport { Map, View } from 'ol';\nimport { fromLonLat, transformExtent, transform } from 'ol/proj';\nimport { Zoom, Attribution, defaults as defaultControls } from 'ol/control';\nimport { boundingExtent } from 'ol/extent';\nimport { WKT } from 'ol/format';\nimport { fromExtent } from 'ol/geom/Polygon';\nimport { ImageAdapter } from './layer-adapters/ImageAdapter';\nimport { EventEmitter } from 'events';\nimport { OsmAdapter } from './layer-adapters/OsmAdapter';\nimport { MarkerAdapter } from './layer-adapters/MarkerAdapter';\nimport { TileAdapter } from './layer-adapters/TileAdapter';\n\ninterface LayerMem {\n  layer: any;\n  onMap: boolean;\n  order?: number;\n  baseLayer?: boolean;\n}\n\nexport default class OlMapAdapter implements MapAdapter {\n\n  static layerAdapters = {\n    IMAGE: ImageAdapter,\n    TILE: TileAdapter,\n    // MVT: MvtAdapter,\n    OSM: OsmAdapter,\n    MARKER: MarkerAdapter,\n  };\n\n  static controlAdapters = {\n    ZOOM: Zoom,\n    ATTRIBUTION: Attribution,\n  };\n\n  options: any;\n\n  layerAdapters = OlMapAdapter.layerAdapters;\n\n  displayProjection = 'EPSG:3857';\n  lonlatProjection = 'EPSG:4326';\n  emitter = new EventEmitter();\n\n  map: Map;\n\n  _layers: { [x: string]: LayerMem } = {};\n  _baseLayers: string[] = [];\n  private _olView: View;\n  private _order = 0;\n  private _length = 9999; // TODO: get real layers length count, after all registered\n\n  private DPI = 1000 / 39.37 / 0.28;\n  private IPM = 39.37;\n\n  // private _layers: {[name: string]: LayerMem} = {};\n\n  // create(options: MapOptions = {target: 'map'}) {\n  create(options = { target: 'map' }) {\n    this.options = Object.assign({}, options);\n    const view = new View({\n      center: [-9101767, 2822912],\n      zoom: 14,\n      projection: this.displayProjection,\n    });\n\n    const defOpt = {\n      logo: false,\n      controls: [],\n      view,\n      layers: [],\n    };\n    const mapInitOptions = { ...defOpt, ...options };\n\n    this.map = new Map(mapInitOptions);\n    this.emitter.emit('create', { map: this.map });\n    this._olView = this.map.getView();\n\n    // olView.on('change:resolution', (evt) => {\n    //   this.set('resolution', olView.getResolution());\n    // });\n\n    // olView.on('change:center', (evt) => {\n    //   this.set('center', olView.getCenter());\n    // });\n\n    this._addMapListeners();\n  }\n\n  getContainer(): HTMLElement {\n    return document.getElementById(this.options.target);\n  }\n\n  onMapLoad(cb?: any) {\n    return new Promise((resolve) => {\n      resolve(cb && cb());\n    });\n  }\n\n  setCenter(latLng: [number, number]) {\n    this._olView.setCenter(fromLonLat(latLng));\n  }\n\n  setZoom(zoom: number) {\n    this._olView.setZoom(zoom);\n  }\n\n  fit(e: [number, number, number, number]) {\n    const toExtent = transformExtent(\n      e,\n      this.lonlatProjection,\n      this.displayProjection,\n    );\n    this._olView.fit(toExtent);\n  }\n\n  setRotation(angle: number) {\n    this._olView.setRotation(angle);\n  }\n\n  getLayerAdapter(name: string) {\n    return OlMapAdapter.layerAdapters[name];\n  }\n\n  getLayer(layerName: string) {\n    return this._layers[layerName] !== undefined;\n  }\n\n  getLayers(): string[] {\n    return Object.keys(this._layers);\n  }\n\n  isLayerOnTheMap(layerName: string): boolean {\n    const layerMem = this._layers[layerName];\n    return layerMem.onMap;\n  }\n\n  addLayer(adapterDef, options?, baselayer?: boolean) {\n\n    let adapterEngine;\n    if (typeof adapterDef === 'string') {\n      adapterEngine = this.getLayerAdapter(adapterDef);\n    }\n    if (adapterEngine) {\n      const adapter = new adapterEngine(this.map, options);\n      const layer = adapter.addLayer(options);\n\n      const addlayerFun = adapter.addLayer(options);\n      const toResolve = (l) => {\n        const layerId = adapter.name;\n        const layerOpts: LayerMem = { layer: l, onMap: false };\n        if (baselayer) {\n          layerOpts.baseLayer = true;\n          this._baseLayers.push(layerId);\n        } else {\n          layerOpts.order = options.order || this._order++;\n        }\n        this._layers[layerId] = layerOpts;\n        // this._length++;\n\n        return adapter;\n      };\n      return addlayerFun.then ? addlayerFun.then((l) => toResolve(l)) : Promise.resolve(toResolve(layer));\n    }\n    return Promise.reject('No adapter');\n  }\n\n  removeLayer(layerName: string) {\n    const layer = this._layers[layerName];\n    if (layer) {\n      this.map.removeLayer(layer.layer);\n      if (layer.baseLayer) {\n        const index = this._baseLayers.indexOf(layerName);\n        if (index) {\n          this._baseLayers.splice(index, 1);\n        }\n      }\n      delete this._layers[layerName];\n    }\n  }\n\n  showLayer(layerName: string) {\n    this.toggleLayer(layerName, true);\n  }\n\n  hideLayer(layerName: string) {\n    this.toggleLayer(layerName, false);\n  }\n\n  setLayerOpacity(layerName: string, value: number) {\n    // ignore\n  }\n\n  getScaleForResolution(res, mpu) {\n    return parseFloat(res) * (mpu * this.IPM * this.DPI);\n  }\n\n  getResolutionForScale(scale, mpu) {\n    return parseFloat(scale) / (mpu * this.IPM * this.DPI);\n  }\n\n  toggleLayer(layerName: string, status: boolean) {\n    const action = (source: Map, l: LayerMem) => {\n      if (status) {\n        if (source instanceof Map) {\n          l.layer.setZIndex(this._length - l.order);\n          source.addLayer(l.layer);\n        }\n      } else {\n        source.removeLayer(l.layer);\n      }\n      l.onMap = status;\n    };\n    const layer = this._layers[layerName];\n    if (layer && layer.onMap !== status) {\n      if (this.map) {\n        action(this.map, layer);\n      } else {\n        this.emitter.once('create', (data) => {\n          action(data.map, layer);\n        });\n      }\n    }\n  }\n\n  addControl(controlDef, position?: string, options?) {\n    let control;\n    if (typeof controlDef === 'string') {\n      const engine = OlMapAdapter.controlAdapters[controlDef];\n      if (engine) {\n        control = new engine(options);\n      }\n    } else {\n      control = controlDef;\n    }\n    if (control) {\n      this.map.addControl(control);\n      return control;\n    }\n  }\n\n  onMapClick(evt) {\n    const [lng, lat] = transform(\n      evt.coordinate,\n      this.displayProjection,\n      this.lonlatProjection,\n    );\n    const latLng = {\n      lat, lng,\n    };\n    this.emitter.emit('click', {\n      latLng,\n      pixel: { left: evt.pixel[0], top: evt.pixel[1] },\n      source: evt,\n    });\n  }\n\n  requestGeomString(pixel: { top: number, left: number }, pixelRadius = 5) {\n    const { top, left } = pixel;\n    const olMap = this.map;\n    const bounds = boundingExtent([\n      olMap.getCoordinateFromPixel([\n        left - pixelRadius,\n        top - pixelRadius,\n      ]),\n      olMap.getCoordinateFromPixel([\n        left + pixelRadius,\n        top + pixelRadius,\n      ]),\n    ]);\n\n    return new WKT().writeGeometry(\n      fromExtent(bounds));\n  }\n\n  private _addMapListeners() {\n    this.map.on('click', (evt) => {\n      this.onMapClick(evt);\n    });\n  }\n}\n"],"sourceRoot":""}