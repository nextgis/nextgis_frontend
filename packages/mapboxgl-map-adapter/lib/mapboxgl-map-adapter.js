!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("mapbox-gl"),require("events")):"function"==typeof define&&define.amd?define(["mapbox-gl","events"],e):"object"==typeof exports?exports.MapboxglMapAdapter=e(require("mapbox-gl"),require("events")):t.MapboxglMapAdapter=e(t["mapbox-gl"],t.events)}(window,function(t,e){return function(t){var e={};function o(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=t,o.c=e,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=2)}([function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e,o){"use strict";o.r(e);var r=1,n=function(){function t(t,e){this.map=t,this.name=e.id||String(r++),this.options=Object.assign({},this.options,e)}return t.prototype.addLayer=function(t){return""},t}(),i=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.addLayer=function(t){t=Object.assign({},this.options,t||{});var e=String(this.name),o={id:e,type:t.type||"fill","source-layer":t["source-layer"]||e,source:{type:"vector",tiles:[t.url]},layout:{visibility:"none"}};return t.paint&&(o.paint=t.paint),this.map.addLayer(o,t.before),this.name},e}(n),s=o(0),u=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),p=function(){return(p=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},c=1,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.addLayer=function(t){this.name=t.id||"tile-"+c++;var e,o=p({},this.options,t||{});return e=o&&o.subdomains?o.subdomains.split("").map(function(t){return o.url.replace("{s}",t)}):[o.url],this.map.addLayer({id:String(this.name),type:"raster",layout:{visibility:"none"},source:{type:"raster",tiles:e,tileSize:o&&o.tileSize||256}},t.before),this.name},e}(n),l=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),y={url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright" target="_blank">OpenStreetMap</a> contributors',subdomains:"abc"},d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.addLayer=function(e){return t.prototype.addLayer.call(this,Object.assign({},y,e))},e}(f),h=o(1),_=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),v=function(t){function e(e){void 0===e&&(e={});return e=Object.assign({},e,{showCompass:!1}),t.call(this,e)||this}return _(e,t),e}(s.NavigationControl),m=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),g=function(t){function e(e){void 0===e&&(e={});return e=Object.assign({},e,{showZoom:!1}),t.call(this,e)||this}return m(e,t),e}(s.NavigationControl),b=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return b(e,t),e}(s.AttributionControl),L=function(){function t(){this.displayProjection="EPSG:3857",this.lonlatProjection="EPSG:4326",this.emitter=new h.EventEmitter,this.layerAdapters=t.layerAdapters,this._layers={},this._baseLayers=[],this.DPI=1e3/39.37/.28,this.IPM=39.37,this.isLoaded=!1,this.orders=[],this._sourcedataloading={}}return t.prototype.create=function(t){this.map||(this.options=t,this.map=new s.Map({container:t.target,center:[96,63],zoom:2,style:{version:8,name:"Empty style",sources:{},layers:[]}}),this._addEventsListeners())},t.prototype.getContainer=function(){return this.map.getContainer()},t.prototype.setCenter=function(t){},t.prototype.setZoom=function(t){},t.prototype.fit=function(t){this.map.fitBounds([[t[0],t[1]],[t[2],t[3]]])},t.prototype.setRotation=function(t){},t.prototype.showLayer=function(t){var e=this;this.onMapLoad(function(){return e.toggleLayer(t,!0)})},t.prototype.hideLayer=function(t){var e=this;this.onMapLoad(function(){return e.toggleLayer(t,!1)})},t.prototype.addLayer=function(t,e,o){var r=this;return this.onMapLoad(function(){var n;if("string"==typeof t&&(n=r.getLayerAdapter(t)),n){var i=new n(r.map,e);o&&r.orders.length&&(e.before=r.orders[0]);var a=i.addLayer(e),s=function(){var t=i.name;return r._layers[t]=!1,r.orders.push(t),r._baseLayers.push(t),o?r.map.moveLayer(t,r.orders[0]):r.map.moveLayer(t),i};return a.then?a.then(function(t){return s()}):Promise.resolve(s())}})},t.prototype.removeLayer=function(t){this._layers[t]&&(this.map.removeLayer(t),this.map.removeSource(t),delete this._layers[t])},t.prototype.getLayer=function(t){return void 0!==this._layers[t]},t.prototype.isLayerOnTheMap=function(t){return this._layers[t]},t.prototype.getLayers=function(){return Object.keys(this._layers)},t.prototype.setLayerOpacity=function(t,e){var o=this;this.onMapLoad().then(function(){var r=o.map.getLayer(t);r&&o.map.setPaintProperty(t,r.type+"-opacity",e)})},t.prototype.getScaleForResolution=function(t,e){return parseFloat(t)*(e*this.IPM*this.DPI)},t.prototype.getResolutionForScale=function(t,e){return parseFloat(t)/(e*this.IPM*this.DPI)},t.prototype.onMapLoad=function(t){var e=this;return new Promise(function(o){e.isLoaded?o(t&&t()):e.map.once("load",function(){e.isLoaded=!0,o(t&&t())})})},t.prototype.toggleLayer=function(t,e){var o=this;this.onMapLoad().then(function(){var r=o._layers[t];void 0!==r&&r!==e&&(o.map.setLayoutProperty(t,"visibility",e?"visible":"none"),o._layers[t]=e)})},t.prototype.addControl=function(e,o,r){var n;if("string"==typeof e){var i=t.controlAdapters[e];i&&(n=new i(r))}else n=e;n&&this.map.addControl(n,o)},t.prototype.onMapClick=function(t){var e=t.lngLat,o=t.point,r=o.x,n=o.y;this.emitter.emit("click",{latLng:e,pixel:{top:n,left:r}})},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype._addEventsListeners=function(){var t=this;this.map.on("sourcedataloading",function(e){t._sourcedataloading[e.sourceId]=t._sourcedataloading[e.sourceId]||[],e.tile&&t._sourcedataloading[e.sourceId].push(e.tile)}),this.map.on("sourcedata",function(e){if("source"===e.dataType){var o=function(e){t._layers[e]&&t.emitter.emit("data-loaded",{target:e})};if(e.isSourceLoaded)Object.keys(t._sourcedataloading).forEach(function(t){o(t)}),t._sourcedataloading={};else{var r=t._sourcedataloading[e.sourceId];if(r&&e.tile){var n=r.indexOf(e.tile);-1!==n&&t._sourcedataloading[e.sourceId].splice(n,1),r.length||(o(e.sourceId),delete t._sourcedataloading[e.sourceId])}}}}),this.map.on("click",function(e){t.onMapClick(e)})},t.layerAdapters={TILE:f,MVT:a,OSM:d},t.controlAdapters={ZOOM:v,COMPASS:g,ATTRIBUTION:O},t}();e.default=L}]).default});
//# sourceMappingURL=mapboxgl-map-adapter.js.map